function updateInput(a,t){-1==a.toLowerCase().indexOf("pi")&&-1==a.toLowerCase().indexOf("theta")||$(t).val(a.replace(/theta/gi,"θ").replace(/pi/gi,"π"))}function handleClick(a){if(isGraph){var t=a.x,e=a.y;t-=.3*window.innerWidth+canvas.width/2+canvas.offsetLeft,e-=canvas.offsetTop,e=canvas.height/2-e,t/=scalingFactor,e/=scalingFactor;var n=Math.atan2(e,t);n<0&&(n=2*Math.PI+n);for(var c,o,i=calculateTheta(),r=0;r<i.length;r++)if(n<=i[r]){c=i[r-1],o=i[r];break}console.log(n),console.log(i),console.log(c+", "+o),fillInArea(c,o),updateIntegral(0,1,5)}}function updateIntegral(a,t,e){$("#integralrepresentation p").html("$$\\frac{1}{2}\\int_{"+a+"}^{"+t+"} r^2 dθ = "+e+"$$");var n=document.getElementById("integralrepresentation");MathJax.Hub.Queue(["Typeset",MathJax.Hub,n])}function calculateTheta(){for(var a=[],t=lowerBound;t<=upperBound;t+=.001)Math.abs(node.eval({x:t}))<=.001&&a.push(t);return a}function fillInArea(a,t){ctx.strokeStyle="#dcdcdc",ctx.lineWidth=1;for(var e=a;e<=t;e+=step){var n=node.eval({x:e}),c=n*math.eval("cos("+e+")")*scalingFactor,o=n*math.eval("sin("+e+")")*scalingFactor;ctx.beginPath(),ctx.moveTo(canvas.width/2,canvas.height/2),ctx.lineTo(canvas.width/2+c,canvas.height/2-o),ctx.stroke()}}function getMousePos(a){var t=canvas.getBoundingClientRect();return{x:(a.clientX-t.left-canvas.width/2)/scalingFactor,y:(canvas.height/2-a.clientY-t.top)/scalingFactor}}function submitEquation(){expression=$("#expression").val().replace(/θ/g,"x"),node=math.parse(expression),isGraph=!0,$("#coordinates").show(),step=parseFloat($("#step").val()),lowerBound=math.eval($("#lowerbound").val().replace(/π/g,"pi")),upperBound=math.eval($("#upperbound").val().replace(/π/g,"pi")),scalingFactor=(canvas.height-40)/(2*Math.round(getMaxRadius())),ctx.clearRect(0,0,canvas.width,canvas.height),drawAxes(),drawGrid(),drawGraph()}function drawAxes(){ctx.strokeStyle="#222831",ctx.lineWidth=2,ctx.beginPath(),ctx.moveTo(0,canvas.height/2),ctx.lineTo(canvas.width,canvas.height/2),ctx.stroke(),ctx.beginPath(),ctx.moveTo(canvas.width/2,0),ctx.lineTo(canvas.width/2,canvas.height),ctx.stroke()}function drawGrid(){ctx.beginPath(),ctx.strokeStyle="#9a9a9a",ctx.lineWidth=2;for(a=1;!0&&!(scalingFactor*a>canvas.width/2);a++)ctx.moveTo(0,canvas.height/2+scalingFactor*a),ctx.lineTo(canvas.width,canvas.height/2+scalingFactor*a),ctx.moveTo(0,canvas.height/2-scalingFactor*a),ctx.lineTo(canvas.width,canvas.height/2-scalingFactor*a),ctx.moveTo(canvas.width/2+scalingFactor*a,0),ctx.lineTo(canvas.width/2+scalingFactor*a,canvas.height),ctx.moveTo(canvas.width/2-scalingFactor*a,0),ctx.lineTo(canvas.width/2-scalingFactor*a,canvas.height);ctx.stroke(),ctx.beginPath(),ctx.strokeStyle="#dcdcdc",ctx.lineWidth=1;for(var a=.5;!0&&!(scalingFactor*a>canvas.width/2);a++)ctx.moveTo(0,canvas.height/2+scalingFactor*a),ctx.lineTo(canvas.width,canvas.height/2+scalingFactor*a),ctx.moveTo(0,canvas.height/2-scalingFactor*a),ctx.lineTo(canvas.width,canvas.height/2-scalingFactor*a),ctx.moveTo(canvas.width/2+scalingFactor*a,0),ctx.lineTo(canvas.width/2+scalingFactor*a,canvas.height),ctx.moveTo(canvas.width/2-scalingFactor*a,0),ctx.lineTo(canvas.width/2-scalingFactor*a,canvas.height);ctx.stroke()}function drawGraph(){ctx.strokeStyle="#0092CA",ctx.lineWidth=2;for(var a,t,e=lowerBound;e<=upperBound;e+=step){var n=node.eval({x:e}),c=Math.round(n*math.eval("cos("+e+")")*scalingFactor),o=Math.round(n*math.eval("sin("+e+")")*scalingFactor);e==lowerBound?(ctx.fillRect(canvas.width/2+c,canvas.height/2-o,2,2),ctx.beginPath()):(ctx.moveTo(canvas.width/2+a,canvas.height/2-t),ctx.lineTo(canvas.width/2+c,canvas.height/2-o)),a=c,t=o}ctx.stroke()}function getMaxRadius(){for(var a=math.derivative(expression,"x"),t=[lowerBound,upperBound],e=lowerBound;e<=upperBound;e+=.001){var n=a.eval({x:e});Math.abs(n)<=.001&&t.push(e)}for(var c=node.eval({x:lowerBound}),o=1;o<t.length;o++)node.eval({x:t[o]})>c&&(c=node.eval({x:t[o]}));return c}function integrate(a,t,e){for(var n=math.parse(a),c=0,o=0,i=0,r=t;r<=e-5e-4;r+=5e-4)c+=5e-4*n.eval({x:r}),o+=5e-4*n.eval({x:r+5e-4}),i+=5e-4*n.eval({x:r+25e-5});return(2*i+(c+o)/2)/3}function truncate(a){return(a=""+a).substring(0,Math.min(a.length,7))}var step,scalingFactor,expression,node,lowerBound,upperBound,canvas,ctx,isGraph=!1;$(document).ready(function(){(canvas=document.getElementById("graphCanvas")).width=.7*window.innerWidth,canvas.height=window.innerHeight,ctx=canvas.getContext("2d"),canvas.addEventListener("mousedown",handleClick,!1),$("#expression, .bound, #step").keypress(function(a){return!(a.which&&13==a.which||a.keyCode&&13==a.keyCode)||($("#button").click(),!1)}),canvas.addEventListener("mousemove",function(a){var t=getMousePos(a),e=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)),n=Math.atan2(t.y,t.x);n<0&&(n=2*Math.PI+n),$("#polar").html(truncate(e)+", "+truncate(n)),$("#rectangular").html(truncate(t.x)+", "+truncate(t.y))},!1)});