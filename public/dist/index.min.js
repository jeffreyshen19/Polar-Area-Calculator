function updateInput(e,a){-1==e.toLowerCase().indexOf("pi")&&-1==e.toLowerCase().indexOf("theta")||$(a).val(e.replace(/theta/gi,"θ").replace(/pi/gi,"π")),"#expression"===a&&-1!=e.indexOf("*")&&$(a).val(e.replace(/\*/gi,"•"))}function desktopMode(){$("#mobile").hide(),$("#sidebar").show(),$("#graph").show()}function mobileMode(){$("#mobile").show(),$("#sidebar").hide(),$("#graph").hide()}function handleClick(e){if($("#error").hide(),isGraph){var a=e.x,t=e.y;a-=.3*window.innerWidth+canvas.width/2+canvas.offsetLeft,t-=canvas.offsetTop,t=canvas.height/2-t,a/=scalingFactor,t/=scalingFactor;var n=Math.atan2(t,a);n<0&&(n=2*Math.PI+n);var i=node.eval({x:n});i<0&&node.eval({x:n+Math.PI})<0&&(i=Math.abs(node.eval({x:n+Math.PI})));var r=Math.sqrt(Math.pow(a,2)+Math.pow(t,2));if(i>=0&&r<=Math.abs(i)){for(var o,c,h=calculateTheta(),s=0;s<h.length;s++)if(n<=h[s]){o=0==s?h[h.length-1]:h[s-1],c=h[s];break}if(null==o&&null==c&&(o=h[h.length-1],c=h[0],Math.abs(c-o)<=.07))return void displayError("You need to click on an actual zone!");o>c&&(o-=2*Math.PI),ctx.putImageData(imageData,0,0),ctx.strokeStyle="#dcdcdc",ctx.lineWidth=2,thetaWhenFillingArea=o,lowerBoundWhenFillingArea=o,upperBoundWhenFillingArea=c,window.requestAnimationFrame(fillInArea),updateIntegral(convertToPi(o),convertToPi(c),truncate(.5*integrate(expression+"^2",o,c)))}else displayError("You need to click on an actual zone!")}}function updateIntegral(e,a,t){$("#integralrepresentation p").html("$$\\frac{1}{2}\\int_{"+e+"}^{"+a+"} r^2 dθ = "+t+"$$");var n=document.getElementById("integralrepresentation");MathJax.Hub.Queue(["Typeset",MathJax.Hub,n])}function calculateTheta(){for(var e=[],a=lowerBound;a<=upperBound;a+=.001){var t=node.eval({x:a});t<=.002&&t>=0&&e.push(a)}return e}function fillInArea(){if(thetaWhenFillingArea<=upperBoundWhenFillingArea){var e=Math.abs(node.eval({x:thetaWhenFillingArea})),a=e*math.eval("cos("+thetaWhenFillingArea+")")*scalingFactor,t=e*math.eval("sin("+thetaWhenFillingArea+")")*scalingFactor;ctx.beginPath(),ctx.moveTo(canvas.width/2,canvas.height/2),ctx.lineTo(canvas.width/2+a,canvas.height/2-t),ctx.stroke(),thetaWhenFillingArea+=step,window.requestAnimationFrame(fillInArea)}}function getMousePos(e){var a=canvas.getBoundingClientRect();return{x:(e.clientX-a.left-canvas.width/2)/scalingFactor,y:(canvas.height/2-e.clientY-a.top)/scalingFactor}}function submitEquation(){ctx.clearRect(0,0,canvas.width,canvas.height),$("#loading").show(),setTimeout(function(){expression=$("#expression").val().replace(/θ/g,"x").replace(/π/g,"pi").replace(/•/g,"*"),node=math.parse(expression),step=parseFloat($("#step").val()),lowerBound=math.eval($("#lowerbound").val().replace(/π/g,"pi")),upperBound=math.eval($("#upperbound").val().replace(/π/g,"pi"));try{node.eval({x:lowerBound})}catch(e){return void displayError("Oops! We couldn't parse that equation")}isGraph=!0,$("#error").hide(),$("#coordinates").show(),$("#polar").html(""),$("#rectangular").html(""),$("#integralrepresentation p").html(""),scalingFactor=(canvas.height-40)/(2*Math.round(getMaxRadius())),drawAxes(),drawGrid(),drawGraph(),imageData=ctx.getImageData(0,0,canvas.width,canvas.height),$("#loading").hide()},0)}function drawAxes(){ctx.strokeStyle="#222831",ctx.lineWidth=2,ctx.beginPath(),ctx.moveTo(0,canvas.height/2),ctx.lineTo(canvas.width,canvas.height/2),ctx.stroke(),ctx.beginPath(),ctx.moveTo(canvas.width/2,0),ctx.lineTo(canvas.width/2,canvas.height),ctx.stroke()}function drawGrid(){ctx.beginPath(),ctx.strokeStyle="#9a9a9a",ctx.lineWidth=2;for(e=1;!0&&!(scalingFactor*e>canvas.width/2);e++)ctx.arc(canvas.width/2,canvas.height/2,scalingFactor*e,0,2*Math.PI);ctx.stroke(),ctx.beginPath(),ctx.strokeStyle="#dcdcdc",ctx.lineWidth=1;for(var e=.5;!0&&!(scalingFactor*e>canvas.width/2);e++)ctx.arc(canvas.width/2,canvas.height/2,scalingFactor*e,0,2*Math.PI);ctx.stroke()}function drawGraph(){ctx.strokeStyle="#0092CA",ctx.lineWidth=2;for(var e,a,t=lowerBound;t<=upperBound;t+=step){var n=node.eval({x:t}),i=Math.round(n*math.eval("cos("+t+")")*scalingFactor),r=Math.round(n*math.eval("sin("+t+")")*scalingFactor);t==lowerBound?(ctx.fillRect(canvas.width/2+i,canvas.height/2-r,2,2),ctx.beginPath()):(ctx.moveTo(canvas.width/2+e,canvas.height/2-a),ctx.lineTo(canvas.width/2+i,canvas.height/2-r)),e=i,a=r}ctx.stroke()}function getMaxRadius(){for(var e=math.derivative(expression,"x"),a=[lowerBound,upperBound],t=lowerBound;t<=upperBound;t+=.001){var n=e.eval({x:t});Math.abs(n)<=.001&&a.push(t)}for(var i=node.eval({x:lowerBound}),r=1;r<a.length;r++){var o=Math.abs(node.eval({x:a[r]}));o>i&&(i=o)}return i}function displayError(e){$("#error").html(e),$("#error").show()}function integrate(e,a,t){for(var n=math.parse(e),i=0,r=0,o=0,c=a;c<=t-5e-4;c+=5e-4)i+=5e-4*n.eval({x:c}),r+=5e-4*n.eval({x:c+5e-4}),o+=5e-4*n.eval({x:c+25e-5});return(2*o+(i+r)/2)/3}function truncate(e){return(e=""+e).substring(0,Math.min(e.length,7))}function convertToPi(e){for(var a=[-2,-1,-.5,-1/3,-.25,-1/6,0,1/6,.25,1/3,.5,1,2],t=["-2π","-π","-\\frac{π}{2}","-\\frac{π}{3}","-\\frac{π}{4}","-\\frac{π}{6}","0","\\frac{π}{6}","\\frac{π}{4}","\\frac{π}{3}","\\frac{π}{2}","π","2π"],n=0;n<a.length;n++)if(Math.abs(Math.PI*a[n]-e)<.01)return t[n];return truncate(e)}$(document).keyup(function(e){var a=$("#expression").val();83==e.which&&-1!=a.search(/cos$/gi)&&$("#expression").val(a.replace(/cos/gi,"cos(")),78==e.which&&(-1!=a.search(/sin$/gi)?$("#expression").val(a.replace(/sin/gi,"sin(")):-1!=a.search(/tan$/gi)&&$("#expression").val(a.replace(/tan/gi,"tan(")))}),$(window).resize(function(){window.innerWidth<1100||window.innerHeight<450?mobileMode():desktopMode(),canvas.width=.7*window.innerWidth,canvas.height=window.innerHeight,isGraph&&submitEquation()});var imageData,thetaWhenFillingArea,lowerBoundWhenFillingArea,upperBoundWhenFillingArea,step,scalingFactor,expression,node,lowerBound,upperBound,canvas,ctx,isGraph=!1;$(document).ready(function(){(canvas=document.getElementById("graphCanvas")).width=.7*window.innerWidth,canvas.height=window.innerHeight,ctx=canvas.getContext("2d"),canvas.addEventListener("mousedown",handleClick,!1),$("#expression, .bound, #step").keypress(function(e){return!(e.which&&13==e.which||e.keyCode&&13==e.keyCode)||($("#button").click(),!1)}),canvas.addEventListener("mousemove",function(e){var a=getMousePos(e),t=Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2)),n=Math.atan2(a.y,a.x);n<0&&(n=2*Math.PI+n),$("#polar").html(truncate(t)+", "+truncate(n)),$("#rectangular").html(truncate(a.x)+", "+truncate(a.y))},!1),(window.innerWidth<1100||window.innerHeight<450)&&mobileMode()});